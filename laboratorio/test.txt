;GNU CLISP  2.49.60

;;ES UNA FUNCION QUE DICE ES ESTE NUMERO PRIMO O NO?
(DEFUN PRIMEP (NUMBER)
  (WHEN (> NUMBER 1)
    (LOOP FOR FAC FROM 2 TO (ISQRT NUMBER) NEVER (ZEROP (MOD NUMBER FAC)))))
;ES UNA FUNCUON QUE BUSCA EL SIGUIENTE NUMERO PRIMO
(DEFUN NEXT-PRIME (NUMBER)
  (LOOP FOR N FROM NUMBER WHEN (PRIMEP N) RETURN N))



;(DO ((P (NEXT-PRIME 0) (NEXT-PRIME (1+ P))))
;    ((> P 19))
;  (FORMAT T "~D " P))

(DEFMACRO DO-PRIMES ((VAR START END) &BODY BODY)
  `(DO ((,VAR (NEXT-PRIME ,START) (NEXT-PRIME (1+ ,VAR))))
       ((> ,VAR ,END))
     ,@BODY))

(DO-PRIMES (P 0 19) (FORMAT T "~D "P))